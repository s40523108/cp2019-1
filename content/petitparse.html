<!DOCTYPE html><html>
        <head>
        <title>2019 Fall 計算機程式課程網頁</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700,900" rel="stylesheet">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>

<!-- for LaTeX equations 暫時不用
<script src="https://scrum-3.github.io/web/math/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
-->
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->

</head>
<body>
<div class='container'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class="container-fluid">
                <div class="row align-items-center">
                <h1>2019 Fall 計算機程式課程網頁</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">2019 Fall 計算機程式課程網頁</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">Site Map</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li class='has-children'><a href='About.html'>About</a><ul class='dropdown'><li><a href='課程簡介.html'>課程簡介</a><li><a href='課程表單.html'>課程表單</a><li><a href='亂數分組.html'>亂數分組</a><li><a href='FFmpeg.html'>FFmpeg</a><li><a href='QandA.html'>QandA</a><li class='has-children'><a href='USB 隨身碟.html'>USB 隨身碟</a><ul class='dropdown'><li><a href='USB 程式系統.html'>USB 程式系統</a><li><a href='Ubuntu 伺服器.html'>Ubuntu 伺服器</a></li></ul><li><a href='課程筆記.html'>課程筆記</a></li></ul><li class='has-children'><a href='Tasks.html'>Tasks</a><ul class='dropdown'><li class='has-children'><a href='Task1.html'>Task1</a><ul class='dropdown'><li><a href='cp1a 分組名單.html'>cp1a 分組名單</a><li><a href='cp1b 分組名單.html'>cp1b 分組名單</a></li></ul><li><a href='Task2.html'>Task2</a><li><a href='Task3.html'>Task3</a><li><a href='Task4.html'>Task4</a><li><a href='Project.html'>Project</a></li></ul><li class='has-children'><a href='Github.html'>Github</a><ul class='dropdown'><li><a href='Github Guide.html'>Github Guide</a><li class='has-children'><a href='Fossil SCM.html'>Fossil SCM</a><ul class='dropdown'><li><a href='Fossil 伺服器.html'>Fossil 伺服器</a><li><a href='Fossil 操作.html'>Fossil 操作</a><li><a href='Fossil 指令.html'>Fossil 指令</a></li></li></ul></ul><li class='has-children'><a href='DartLang.html'>DartLang</a><ul class='dropdown'><li><a href='Dart2 Spec.html'>Dart2 Spec</a></li></ul><li class='has-children'><a href='Reference.html'>Reference</a><ul class='dropdown'><li><a href='Python.html'>Python</a><li><a href='Ebooks.html'>Ebooks</a><li class='has-children'><a href='Flutter.html'>Flutter</a><ul class='dropdown'><li><a href='Flutter Mobile.html'>Flutter Mobile</a><li><a href='Flutter Web.html'>Flutter Web</a><li><a href='Flutter Desktop.html'>Flutter Desktop</a></li></ul><li class='has-children'><a href='Dart.html'>Dart</a><ul class='dropdown'><li><a href='Dart on Server.html'>Dart on Server</a><li><a href='DartPad.html'>DartPad</a><li><a href='petitparse.html'>petitparse</a><li><a href='MOCAD.html'>MOCAD</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">DartPad << <a href='DartPad.html'>Previous</a> <a href='MOCAD.html'>Next</a> >> MOCAD<br /><h1>petitparse</h1>
<p><a href="https://github.com/petitparser/dart-petitparser">https://github.com/petitparser/dart-petitparser</a></p>
<p><a href="https://pub.dev/packages/petitparser">https://pub.dev/packages/petitparser</a></p>
<h4>應用</h4>
<p>mkdir mocad</p>
<p>將 pubspec.yaml 放入 modad 目錄</p>
<p>cd mocad 後執行 pub install</p>
<p>執行 dart mocad.dart</p>
<p>得到結果:</p>
<p style="padding-left: 30px;">[null, null, 12, null, null, 23, null, null, 5]<br/>Success[1:12]: 40</p>
<p></p>
<p>表示 pititparser 成功解析出字串中的數字, 並且求出所有數字的和</p>
<p style="padding-left: 30px;">(digit().plus().flatten() | any().map((_) =&gt; null)).star()</p>
<p>表示, 先匹配多個連在一起的數字, 如果無法匹配, 則以 null 代替. 然後不斷重複此一過程直到解析完整個字串</p>
<p>其中使用下列解析語法:</p>
<p>digit() 解析一個數字<br/>any() 解析任一字串<br/>plus() 重複一次或多次<br/>star() 重複零次或多次<br/>flatten() 將匹配的結果轉為字串, 而不是數列<br/>map() 對匹配的結果進行轉換</p>
<p>pubspec.yaml</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">name: mocad
version: 0.0.1
dependencies:
  petitparser: ^2.4.0</pre>
<p>mocad.dart</p>
<pre class="brush:dart;auto-links:false;toolbar:false" contenteditable="false">import "package:petitparser/petitparser.dart";

main() {
  var str = 'aa12bb23cc5';
  var parser =
      (digit().plus().flatten() | any().map((_) =&gt; null)).star().map((each) {
    print(each);
    var total = 0;
    for (String numStr in each) {
      if (numStr != null) {
        total += int.parse(numStr);
      }
    }
    return total;
  });
  var total = parser.parse(str);
  print(total);
}
</pre>
<p>Another example:</p>
<p>calc.dart</p>
<pre class="brush:dart;auto-links:false;toolbar:false" contenteditable="false">/// Calculator from the tutorial.
library petitparser.example.calc;

import 'dart:math';

import 'package:petitparser/petitparser.dart';

Parser buildParser() {
  final builder = ExpressionBuilder();
  builder.group()
    ..primitive((pattern('+-').optional() &amp;
            digit().plus() &amp;
            (char('.') &amp; digit().plus()).optional() &amp;
            (pattern('eE') &amp; pattern('+-').optional() &amp; digit().plus())
                .optional())
        .flatten('number expected')
        .trim()
        .map(num.tryParse))
    ..wrapper(
        char('(').trim(), char(')').trim(), (left, value, right) =&gt; value);
  builder.group()..prefix(char('-').trim(), (op, a) =&gt; -a);
  builder.group()..right(char('^').trim(), (a, op, b) =&gt; pow(a, b));
  builder.group()
    ..left(char('*').trim(), (a, op, b) =&gt; a * b)
    ..left(char('/').trim(), (a, op, b) =&gt; a / b);
  builder.group()
    ..left(char('+').trim(), (a, op, b) =&gt; a + b)
    ..left(char('-').trim(), (a, op, b) =&gt; a - b);
  return builder.build().end();
}

void main(List&lt;String&gt; arguments) {
  final parser = buildParser();
  final input = arguments.join(' ');
  final result = parser.parse(input);
  if (result.isSuccess) {
    print(' = ${result.value}');
  } else {
    print(input);
    print('${' ' * (result.position - 1)}^-- ${result.message}');
  }
}
</pre>
<p>dart calc.dart 3+5*9-4</p>
<p style="padding-left: 30px;">會列出 = 44</p>
<p>接下來要嘗試利用 petitparser 解析</p>
<p>M[J[R,color[Green],P[0,0],L[ground,L1]],J[R,color[Green],P[12.92,32.53],L[L1,L2]],J[R,color[Green],P[73.28,67.97],L[L2,L3]],J[R,color[Green],P[33.3,66.95],L[L2]],J[R,color[Green],P[90,0],L[ground,L3]]]</p>
<p>以計算機構自由度, 各點座標位置, 以及所使用轉動軸類型與總數.</p>
<h4>參考資料</h4>
<p style="padding-left: 30px;"><a href="./../downloads/PetitParser.pdf">PetitParser.pdf</a></p>
<p style="padding-left: 30px;"><a href="./../downloads/Parsing Contexts-Context Sensitive Grammars for Everyone.pdf">Parsing Contexts-Context Sensitive Grammars for Everyone.pdf</a></p>
<p style="padding-left: 30px;"><a href="https://www.lukas-renggli.ch/blog/petitparser-java-dart">https://www.lukas-renggli.ch/blog/petitparser-java-dart</a></p>
<p style="padding-left: 30px;"><a href="https://en.wikipedia.org/wiki/Comparison_of_parser_generators">https://en.wikipedia.org/wiki/Comparison_of_parser_generators</a></p>
<p style="padding-left: 30px;"><a href="https://pypi.org/project/ptTools/">https://pypi.org/project/ptTools/</a></p>
<p style="padding-left: 30px;">Pyslvs use lark to parse PMKS format mechanism string.</p>
<p style="padding-left: 60px;"><a href="https://github.com/lark-parser/lark">https://github.com/lark-parser/lark</a></p>
<p style="padding-left: 60px;"><a href="https://pypi.org/project/parsimonious/">https://pypi.org/project/parsimonious/</a></p>
<p style="padding-left: 60px;"><a href="https://en.wikipedia.org/wiki/Parsing_expression_grammar">PEG</a> vs <a href="https://en.wikipedia.org/wiki/LALR_parser">LAIR</a>: <a href="https://github.com/lark-parser/lark/issues/218">https://github.com/lark-parser/lark/issues/218</a></p>
<p style="padding-left: 30px;">var parser = letter().seq(letter().or(digit()).star());</p>
<p style="padding-left: 30px;">var parser = letter() &amp; (letter() | digit()).star();</p>
<p style="padding-left: 30px;">var parser = digit().plus().flatten().map((input) =&gt; Math.parseInt(input));</p>
<p style="padding-left: 30px;"><a href="https://github.com/KmolYuan/Pyslvs-UI">Pyslvs</a> 中用於解析機構表示式的 <a href="https://github.com/KmolYuan/pyslvs/blob/master/pyslvs/expression_parser.py">expression_parser.py</a></p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false"># -*- coding: utf-8 -*-

"""Lark parser to parse the expression."""

__author__ = "Yuan Chang"
__copyright__ = "Copyright (C) 2016-2019"
__license__ = "AGPL"
__email__ = "pyslvs@gmail.com"

from typing import (
    Tuple,
    List,
    Dict,
    Iterator,
    Union,
    Optional,
)
from lark import Lark, Transformer, LexError
from lark.lexer import Token
try:
    from .expression import (
        get_vlinks,
        VJoint,
        VPoint,
        VLink,
    )
    from .graph import Graph
except ImportError:
    from expression import (
        get_vlinks,
        VJoint,
        VPoint,
        VLink,
    )
    from graph import Graph

# Color dictionary.
_color_list: Dict[str, Tuple[int, int, int]] = {
    'Red': (172, 68, 68),
    'Green': (110, 190, 30),
    'Blue': (68, 120, 172),
    'Cyan': (0, 255, 255),
    'Magenta': (255, 0, 255),
    'Brick-Red': (255, 130, 130),
    'Yellow': (255, 255, 0),
    'Gray': (160, 160, 160),
    'Orange': (225, 165, 0),
    'Pink': (225, 192, 230),
    'Black': (0, 0, 0),
    'White': (255, 255, 255),
    'Dark-Red': (128, 0, 0),
    'Dark-Green': (0, 128, 0),
    'Dark-Blue': (0, 0, 128),
    'Dark-Cyan': (128, 0, 128),
    'Dark-Magenta': (255, 0, 255),
    'Dark-Yellow': (128, 128, 0),
    'Dark-Gray': (128, 128, 128),
    'Dark-Orange': (225, 140, 0),
    'Dark-Pink': (225, 20, 147),
}

color_names = tuple(sorted(_color_list.keys()))


def color_rgb(name: str) -&gt; Tuple[int, int, int]:
    """Get color by name.

    + Invalid color
    + Color key
    + RGB string "(r, g, b)".
    """
    if name in _color_list:
        return _color_list[name]
    else:
        try:
            # Input RGB as a "(255, 255, 255)" string.
            color_text: Tuple[int, int, int] = tuple(int(i) for i in (
                name.replace('(', '')
                .replace(')', '')
                .replace(" ", '')
                .split(',', maxsplit=3)
            ))
        except ValueError:
            return 0, 0, 0
        else:
            return color_text


_GRAMMAR = Lark(r"""
    // Number
    DIGIT: "0".."9"
    INT: DIGIT+
    SIGNED_INT: ["+" | "-"] INT
    DECIMAL: INT "." INT? | "." INT
    _EXP: ("e" | "E") SIGNED_INT
    FLOAT: INT _EXP | DECIMAL _EXP?
    NUMBER: FLOAT | INT
    SIGNED_NUMBER: ["+" | "-"] NUMBER

    // Letters
    LCASE_LETTER: "a".."z"
    UCASE_LETTER: "A".."Z"
    LETTER: UCASE_LETTER | LCASE_LETTER | "_"
    CNAME: LETTER (LETTER | DIGIT)*

    // White space and new line
    WS: /\s+/
    CR: /\r/
    LF: /\n/
    NEWLINE: (CR? LF)+
    %ignore WS
    %ignore NEWLINE

    // Comment
    LINE_COMMENT: /#[^\n]*/
    MULTILINE_COMMENT: /#\[[\s\S]*#\][^\n]*/
    %ignore LINE_COMMENT
    %ignore MULTILINE_COMMENT

    // Custom data type
    JOINT_TYPE: "RP" | "R" | "P"
    COLOR: """ + "|".join(f'"{color}"' for color in color_names) + r"""
    type: JOINT_TYPE
    name: CNAME
    number: SIGNED_NUMBER
    color_value: INT

    // Main grammar
    joint: "J[" type ["," angle] ["," color] "," point "," link "]"
    link: "L[" [name ("," name)* ","?] "]"
    point: "P[" number "," number "]"
    angle: "A[" number "]"
    color: "color[" (("(" color_value ("," color_value) ~ 2 ")") | COLOR) "]"
    mechanism: "M[" [joint ("," joint)* ","?] "]"
    ?start: mechanism
""", parser='lalr')


class _ParamsTrans(Transformer):

    """Transformer will parse into a list of VPoint data."""

    @staticmethod
    def type(n: List[Token]) -&gt; str:
        return str(n[0])

    name = type

    @staticmethod
    def color(n: List[Token]) -&gt; str:
        return str(n[0]) if len(n) == 1 else str(tuple(n))

    @staticmethod
    def color_value(n: List[Token]) -&gt; int:
        return int(n[0])

    @staticmethod
    def number(n: List[Token]) -&gt; float:
        return float(n[0])

    @staticmethod
    def point(c: List[Token]) -&gt; Tuple[Token]:
        return tuple(c)

    angle = number

    @staticmethod
    def link(a: List[Token]) -&gt; Tuple[Token]:
        return tuple(a)

    @staticmethod
    def joint(args: List[Token]) -&gt; List[Union[str, int, float]]:
        """Sort the argument list.

        [0]: type
        ([1]: angle)
        ([2]: color)
        [-2]: point (coordinate)
        [-1]: link
        """
        type_str = args[0]
        x, y = args[-2]
        links = ','.join(args[-1])
        if type_str == 'R':
            if len(args) == 3:
                return [links, 'R', 'Green', x, y]
            elif len(args) == 4:
                return [links, 'R', args[-3], x, y]
        else:
            type_angle = f'{args[0]}:{args[1]}'
            if len(args) == 4:
                return [links, type_angle, 'Green', x, y]
            elif len(args) == 5:
                return [links, type_angle, args[-3], x, y]

        raise LexError(f"invalid options: {args}")

    @staticmethod
    def mechanism(joints: List[Token]) -&gt; List[Token]:
        return joints


class _PositionTrans(_ParamsTrans):

    """Transformer will parse into a list of position data."""

    @staticmethod
    def joint(args: List[Token]) -&gt; Tuple[float, float]:
        x, y = args[-2]
        return x, y


class _VPointsTrans(_ParamsTrans):

    """Using same grammar return as VPoints."""

    @staticmethod
    def type(n: List[Token]) -&gt; VJoint:
        """Return as int type."""
        type_str = str(n[0])
        if type_str == 'R':
            return VJoint.R
        elif type_str == 'P':
            return VJoint.P
        elif type_str == 'RP':
            return VJoint.RP

    @staticmethod
    def joint(args: List[Token]) -&gt; VPoint:
        """Same as parent."""
        type_int = args[0]
        x, y = args[-2]
        links: Tuple[str, ...] = args[-1]
        if type_int == VJoint.R:
            if len(args) == 3:
                return VPoint.r_joint(links, x, y)
            elif len(args) == 4:
                return VPoint(links, VJoint.R, 0., args[-3], x, y, color_rgb)
        else:
            if len(args) == 4:
                return VPoint.slider_joint(links, type_int, args[1], x, y)
            elif len(args) == 5:
                return VPoint(links, type_int, args[1], args[-3], x, y, color_rgb)

        raise LexError(f"invalid options: {args}")


_params_translator = _ParamsTrans()
_pos_translator = _PositionTrans()
_vpoint_translator = _VPointsTrans()


def parse_params(expr: str) -&gt; List[List[Union[str, float]]]:
    """Using to parse the expression and return arguments."""
    return _params_translator.transform(_GRAMMAR.parse(expr))


def parse_pos(expr: str) -&gt; List[Tuple[float, float]]:
    """Using to parse the expression and return arguments."""
    return _pos_translator.transform(_GRAMMAR.parse(expr))


def parse_vpoints(expr: str) -&gt; List[VPoint]:
    """Parse as VPoints."""
    return _vpoint_translator.transform(_GRAMMAR.parse(expr))


def parse_vlinks(expr: str) -&gt; List[VLink]:
    """Parse as VLinks."""
    return get_vlinks(parse_vpoints(expr))


def edges_view(graph: Graph) -&gt; Iterator[Tuple[int, Tuple[int, int]]]:
    """This generator can keep the numbering be consistent."""
    yield from enumerate(sorted(tuple(sorted(e)) for e in graph.edges))


def graph2vpoints(
    graph: Graph,
    pos: Dict[int, Tuple[float, float]],
    cus: Optional[Dict[int, int]] = None,
    same: Optional[Dict[int, int]] = None,
    grounded: Optional[int] = None
) -&gt; List[VPoint]:
    """Change NetworkX graph into VPoints.

    cus: custom nodes (not joint)
        {node_name: link_number}
    same: multiple joints
        {n1: n2, n3: n2} =&gt; (n1 as n2) and (n3 as n2)
    """
    if cus is None:
        cus: Dict[int, int] = {}
    if same is None:
        same: Dict[int, int] = {}

    same_r = {}
    for k, v in same.items():
        if v in same_r:
            same_r[v].append(k)
        else:
            same_r[v] = [k]
    tmp_list = []
    ev = dict(edges_view(graph))
    for i, edge in ev.items():
        if i in same:
            # Do not connect to anyone!
            continue
        edge = set(edge)
        if i in same_r:
            for j in same_r[i]:
                edge.update(set(ev[j]))
        x, y = pos[i]
        links = [(f"L{link}" if link != grounded else 'ground') for link in edge]
        tmp_list.append(VPoint.r_joint(links, x, y))
    for name in sorted(cus):
        link = f"L{cus[name]}" if cus[name] != grounded else 'ground'
        x, y = pos[name]
        tmp_list.append(VPoint.r_joint((link,), x, y))
    return tmp_list


try:
    from pygments.lexer import RegexLexer
    from pygments.token import (
        Comment,
        Keyword,
        Name,
        Number,
    )
except ImportError:
    HAS_PYGMENTS = False
else:
    HAS_PYGMENTS = True

    class PMKSLexer(RegexLexer):

        """Mechanism expression highlighter by Pygments."""

        name = 'Mechanism Expression'

        tokens = {
            'root': [
                (r'#[^\n]*', Comment.Single),
                (r'#\[[\s\S]*#\][^\n]*', Comment.Multiple),
                (r'M|J|L|P|A|color', Name.Function),
                ('|'.join(f"{color}" for color in reversed(color_names)), Name.Variable),
                (r'RP|R|P', Keyword.Constant),
                (r'(\d+\.\d*|\.\d+)([eE][+-]?\d+)?', Number.Float),
            ]
        }
</pre>
<p style="padding-left: 30px;"></p><br />DartPad << <a href='DartPad.html'>Previous</a> <a href='MOCAD.html'>Next</a> >> MOCAD</div>
        
    <!-- footer -->
      <div class="container">
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        </body></html>
        